

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Code &mdash; virga v0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Switching the Solver" href="notebooks/5_SwitchingSolver.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> virga
          

          
          </a>

          
            
            
              <div class="version">
                0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference external" href="https://zenodo.org/record/3758538#.Xp4w-1NKjOQ">Refractive Indices</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">The Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/natashabatalha/virga">Github</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.calc_mie">virga.calc_mie module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.gas_properties">virga.gas_properties module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.justdoit">virga.justdoit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.justplotit">virga.justplotit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.optics">virga.optics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.pvaps">virga.pvaps module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga.root_functions">virga.roo_functions module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-virga">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">virga</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>The Code</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/virga.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="the-code">
<h1>The Code<a class="headerlink" href="#the-code" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-virga.calc_mie">
<span id="virga-calc-mie-module"></span><h2>virga.calc_mie module<a class="headerlink" href="#module-virga.calc_mie" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="virga.calc_mie.calc_new_mieff">
<code class="sig-prename descclassname">virga.calc_mie.</code><code class="sig-name descname">calc_new_mieff</code><span class="sig-paren">(</span><em class="sig-param">wave_in</em>, <em class="sig-param">nn</em>, <em class="sig-param">kk</em>, <em class="sig-param">radius</em>, <em class="sig-param">rup</em>, <em class="sig-param">fort_calc_mie=False</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.calc_mie.calc_new_mieff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="virga.calc_mie.fort_mie_calc">
<code class="sig-prename descclassname">virga.calc_mie.</code><code class="sig-name descname">fort_mie_calc</code><span class="sig-paren">(</span><em class="sig-param">RO</em>, <em class="sig-param">RFR</em>, <em class="sig-param">RFI</em>, <em class="sig-param">THET</em>, <em class="sig-param">JX</em>, <em class="sig-param">R</em>, <em class="sig-param">RE2</em>, <em class="sig-param">TMAG2</em>, <em class="sig-param">WVNO</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.calc_mie.fort_mie_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the refractive indices at a certain wavelength this module
calculates the Mie scattering by a stratified sphere.The basic code used
was that described in the report: ” Subroutines for computing the parameters of
the electromagnetic radiation scattered by a sphere ” J.V. Dave,
I B M Scientific Center, Palo Alto , California.
Report NO. 320 - 3236 .. MAY 1968 .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RO</strong> (<em>float</em>) – Outer Shell Radius (cm)</p></li>
<li><p><strong>RFR</strong> (<em>float</em>) – Real refractive index of shell layer (in the form n= RFR-i*RFI)</p></li>
<li><p><strong>RFI</strong> (<em>float</em>) – Imaginary refractive index of shell layer (in the form n= RFR-i*RFI)</p></li>
<li><p><strong>THET</strong> (<em>ndarray</em>) – Angle in degrees between the directions of the incident and the scattered radiation.</p></li>
<li><p><strong>JX</strong> (<em>integer</em>) – Total number of THET for which calculations are required</p></li>
<li><p><strong>R</strong> (<em>float</em>) – Radius of core (cm)`</p></li>
<li><p><strong>RE2</strong> (<em>float</em>) – Real refractive index of core (in the form n= RE2-i*TMAG2)</p></li>
<li><p><strong>TMAG2</strong> (<em>float</em>) – Imaginary refractive index of core (in the form n= RE2-i*TMAG2)</p></li>
<li><p><strong>WVNO</strong> (<em>float</em>) – Wave-number corresponding to the wavelength. (cm^-1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>QEXT</strong> (<em>float</em>) – Efficiency factor for extinction,VAN DE HULST,P.14 ‘ 127</p></li>
<li><p><strong>QSCAT</strong> (<em>float</em>) – Efficiency factor for scattering,VAN DE HULST,P.14 ‘ 127</p></li>
<li><p><strong>CTBQRS</strong> (<em>float</em>) – Average(cos(theta))*QSCAT,VAN DE HULST,P.14 ‘ 127</p></li>
<li><p><strong>ISTATUS</strong> (<em>integer</em>) – Convergence indicator, 0 if converged, -1 if otherwise.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.calc_mie.get_r_grid">
<code class="sig-prename descclassname">virga.calc_mie.</code><code class="sig-name descname">get_r_grid</code><span class="sig-paren">(</span><em class="sig-param">r_min=1e-05</em>, <em class="sig-param">n_radii=40</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.calc_mie.get_r_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Get spacing of radii to run Mie code</p>
<dl class="simple">
<dt>r_min<span class="classifier">float</span></dt><dd><p>Minimum radius to compute (cm)</p>
</dd>
<dt>n_radii<span class="classifier">int</span></dt><dd><p>Number of radii to compute</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.calc_mie.get_refrind">
<code class="sig-prename descclassname">virga.calc_mie.</code><code class="sig-name descname">get_refrind</code><span class="sig-paren">(</span><em class="sig-param">igas</em>, <em class="sig-param">directory</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.calc_mie.get_refrind" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads reference files with wavelength, and refractory indecies.
This function relies on input files being structured as a 4 column file with
columns: index, wavelength (micron), nn, kk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>igas</strong> (<em>str</em>) – Gas name</p></li>
<li><p><strong>directory</strong> (<em>str</em>) – Directory were reference files are located.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-virga.gas_properties">
<span id="virga-gas-properties-module"></span><h2>virga.gas_properties module<a class="headerlink" href="#module-virga.gas_properties" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="virga.gas_properties.Al2O3">
<code class="sig-prename descclassname">virga.gas_properties.</code><code class="sig-name descname">Al2O3</code><span class="sig-paren">(</span><em class="sig-param">mw_atmos</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.Al2O3" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines properties for Al2O3 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 2.51e-6</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.gas_properties.CH4">
<code class="sig-prename descclassname">virga.gas_properties.</code><code class="sig-name descname">CH4</code><span class="sig-paren">(</span><em class="sig-param">mw_atmos</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.CH4" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines properties for CH4 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio.
None points to the default value of : 4.9e-4</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>mean molecular weight of gas,</em></p></li>
<li><p><em>gas mass mixing ratio</em></p></li>
<li><p><em>density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.gas_properties.Cr">
<code class="sig-prename descclassname">virga.gas_properties.</code><code class="sig-name descname">Cr</code><span class="sig-paren">(</span><em class="sig-param">mw_atmos</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.Cr" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines properties for Cr as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of :
1xSolar = 8.87e-7
10xSolar = 8.6803E-06
50xSolar = 4.1308E-05</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.gas_properties.Fe">
<code class="sig-prename descclassname">virga.gas_properties.</code><code class="sig-name descname">Fe</code><span class="sig-paren">(</span><em class="sig-param">mw_atmos</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.Fe" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines properties for Fe as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 5.78e-5</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>mean molecular weight of gas,</em></p></li>
<li><p><em>gas mass mixing ratio</em></p></li>
<li><p><em>density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.gas_properties.H2O">
<code class="sig-prename descclassname">virga.gas_properties.</code><code class="sig-name descname">H2O</code><span class="sig-paren">(</span><em class="sig-param">mw_atmos</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.H2O" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines properties for H2O as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 7.54e-4</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>mean molecular weight of gas,</em></p></li>
<li><p><em>gas mass mixing ratio</em></p></li>
<li><p><em>density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.gas_properties.KCl">
<code class="sig-prename descclassname">virga.gas_properties.</code><code class="sig-name descname">KCl</code><span class="sig-paren">(</span><em class="sig-param">mw_atmos</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.KCl" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines properties for KCl as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of :
1xSolar = 2.2627E-07
10xSolar = 2.1829E-06
50xSolar = 8.1164E-06</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.gas_properties.Mg2SiO4">
<code class="sig-prename descclassname">virga.gas_properties.</code><code class="sig-name descname">Mg2SiO4</code><span class="sig-paren">(</span><em class="sig-param">mw_atmos</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.Mg2SiO4" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines properties for Mg2SiO4 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 3.58125e-05</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.gas_properties.MgSiO3">
<code class="sig-prename descclassname">virga.gas_properties.</code><code class="sig-name descname">MgSiO3</code><span class="sig-paren">(</span><em class="sig-param">mw_atmos</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.MgSiO3" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines properties for MgSiO3 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 2.75e-3</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.gas_properties.MnS">
<code class="sig-prename descclassname">virga.gas_properties.</code><code class="sig-name descname">MnS</code><span class="sig-paren">(</span><em class="sig-param">mw_atmos</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.MnS" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines properties for MnS as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 6.32e-7</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.gas_properties.NH3">
<code class="sig-prename descclassname">virga.gas_properties.</code><code class="sig-name descname">NH3</code><span class="sig-paren">(</span><em class="sig-param">mw_atmos</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.NH3" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines properties for NH3 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 1.34e-4</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>mean molecular weight of gas,</em></p></li>
<li><p><em>gas mass mixing ratio</em></p></li>
<li><p><em>density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.gas_properties.Na2S">
<code class="sig-prename descclassname">virga.gas_properties.</code><code class="sig-name descname">Na2S</code><span class="sig-paren">(</span><em class="sig-param">mw_atmos</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.Na2S" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines properties for Na2S as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 3.97e-6</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.gas_properties.TiO2">
<code class="sig-prename descclassname">virga.gas_properties.</code><code class="sig-name descname">TiO2</code><span class="sig-paren">(</span><em class="sig-param">mw_atmos</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.TiO2" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines properties for TiO2 as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio.
None points to the default value of : 1.69e-7</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>mean molecular weight of gas,</em></p></li>
<li><p><em>gas mass mixing ratio</em></p></li>
<li><p><em>density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.gas_properties.ZnS">
<code class="sig-prename descclassname">virga.gas_properties.</code><code class="sig-name descname">ZnS</code><span class="sig-paren">(</span><em class="sig-param">mw_atmos</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.gas_properties.ZnS" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines properties for ZnS as condensible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere amu</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em> , </em><em>optional</em>) – Gas mass mixing ratio
None points to the default value of : 8.40e-8</p></li>
<li><p><strong>mh</strong> (<em>float</em><em> , </em><em>optional</em>) – Metallicity, Default is 1=1xSolar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Mean molecular weight of gas,</em></p></li>
<li><p><em>Gas mass mixing ratio</em></p></li>
<li><p><em>Density of gas cgs</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-virga.justdoit">
<span id="virga-justdoit-module"></span><h2>virga.justdoit module<a class="headerlink" href="#module-virga.justdoit" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="virga.justdoit.Atmosphere">
<em class="property">class </em><code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">Atmosphere</code><span class="sig-paren">(</span><em class="sig-param">condensibles</em>, <em class="sig-param">fsed=0.5</em>, <em class="sig-param">b=1</em>, <em class="sig-param">eps=0.01</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">mmw=2.2</em>, <em class="sig-param">sig=2.0</em>, <em class="sig-param">param='const'</em>, <em class="sig-param">verbose=True</em>, <em class="sig-param">supsat=0</em>, <em class="sig-param">gas_mmr=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="virga.justdoit.Atmosphere.compute">
<code class="sig-name descname">compute</code><span class="sig-paren">(</span><em class="sig-param">directory=None</em>, <em class="sig-param">as_dict=True</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.compute" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmo</strong> (<em>class</em>) – <cite>Atmosphere</cite> class</p></li>
<li><p><strong>directory</strong> (<em>str</em><em>, </em><em>optional</em>) – Directory string that describes where refrind files are</p></li>
<li><p><strong>as_dict</strong> (<em>bool</em>) – Default = True, option to view full output as dictionary</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>dict</em> – When as_dict=True. Dictionary output that contains full output. See tutorials for explanation of all output.</p></li>
<li><p><em>opd, w0, g0</em> – Extinction per layer, single scattering abledo, asymmetry parameter,
All are ndarrays that are nlayer by nwave</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="virga.justdoit.Atmosphere.constants">
<code class="sig-name descname">constants</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.constants" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="virga.justdoit.Atmosphere.get_atmo_parameters">
<code class="sig-name descname">get_atmo_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.get_atmo_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines all the atmospheric parameters needed for the calculation</p>
<p>Note: Some of this is repeated in the layer() function.
This is done on purpose because layer is used to get a “virtual”
layer off the user input’s grid. These parameters are also
needed, though, to get the initial mixing parameters from the user.
Therefore, we put them in both places.</p>
</dd></dl>

<dl class="method">
<dt id="virga.justdoit.Atmosphere.get_kz_mixl">
<code class="sig-name descname">get_kz_mixl</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">constant_kz</em>, <em class="sig-param">latent_heat</em>, <em class="sig-param">convective_overshoot</em>, <em class="sig-param">kz_min</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.get_kz_mixl" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes kz profile and mixing length given user input. In brief the options are:</p>
<ol class="arabic simple">
<li><p>Input Kz</p></li>
<li><p>Input constant kz</p></li>
</ol>
<p>3) Input convective heat flux (supply chf in df)
3a) Input convective heat flux, correct for latent heat (supply chf in df and set latent_heat=True)
and/or 3b) Input convective heat flux, correct for convective overshoot (supply chf, convective_overshoot=1/3)
4) Set kz_min to prevent kz from going too low (any of the above and set kz_min~1e5)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>dataframe</em><em> or </em><em>dict</em>) – Dataframe from input with “pressure”(bars),”temperature”(K). MUST have at least two
columns with names “pressure” and “temperature”.
Optional columns include the eddy diffusion “kz” in cm^2/s CGS units, and
the convective heat flux ‘chf’ also in cgs (e.g. sigma_csg T^4)</p></li>
<li><p><strong>constant_kz</strong> (<em>float</em>) – Constant value for kz, if kz is supplied in df or filename,
it will inheret that value and not use this constant_value
Default = None</p></li>
<li><p><strong>latent_heat</strong> (<em>bool</em>) – optional, Default = False. The latent heat factors into the mixing length.
When False, the mixing length goes as the scale height
When True, the mixing length is scaled by the latent heat</p></li>
<li><p><strong>convective_overshoot</strong> (<em>float</em>) – Optional, Default is None. But the default value used in
Ackerman &amp; Marley 2001 is 1./3. If you are unsure of what to pick, start
there. This is only used when the
This is ONLY used when a chf (convective heat flux) is supplied</p></li>
<li><p><strong>kz_min</strong> (<em>float</em>) – Minimum Kz value. This will reset everything below kz_min to kz_min.
Default = 1e5 cm2/s</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="virga.justdoit.Atmosphere.gravity">
<code class="sig-name descname">gravity</code><span class="sig-paren">(</span><em class="sig-param">gravity=None</em>, <em class="sig-param">gravity_unit=None</em>, <em class="sig-param">radius=None</em>, <em class="sig-param">radius_unit=None</em>, <em class="sig-param">mass=None</em>, <em class="sig-param">mass_unit=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.gravity" title="Permalink to this definition">¶</a></dt>
<dd><p>Get gravity based on mass and radius, or gravity inputs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gravity</strong> (<em>float</em>) – (Optional) Gravity of planet</p></li>
<li><p><strong>gravity_unit</strong> (<em>astropy.unit</em>) – (Optional) Unit of Gravity</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – (Optional) radius of planet MUST be specified for thermal emission!</p></li>
<li><p><strong>radius_unit</strong> (<em>astropy.unit</em>) – (Optional) Unit of radius</p></li>
<li><p><strong>mass</strong> (<em>float</em>) – (Optional) mass of planet</p></li>
<li><p><strong>mass_unit</strong> (<em>astropy.unit</em>) – (Optional) Unit of mass</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="virga.justdoit.Atmosphere.kz">
<code class="sig-name descname">kz</code><span class="sig-paren">(</span><em class="sig-param">df=None</em>, <em class="sig-param">constant_kz=None</em>, <em class="sig-param">chf=None</em>, <em class="sig-param">kz_min=100000.0</em>, <em class="sig-param">latent_heat=False</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.kz" title="Permalink to this definition">¶</a></dt>
<dd><p>Define Kz in CGS. Should be on same grid as pressure. This overwrites whatever was
defined in get_pt ! Users can define kz by:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Defining a DataFrame with keys ‘pressure’ (in bars), and ‘kz’</p></li>
<li><p>Defining constant kz</p></li>
<li><p>Supplying a convective heat flux and prescription for latent_heat</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em><em>, </em><em>dict</em>) – Dataframe or dictionary with ‘kz’ as one of the fields.</p></li>
<li><p><strong>constant_kz</strong> (<em>float</em>) – Constant value for kz in units of cm^2/s</p></li>
<li><p><strong>chf</strong> (<em>ndarray</em>) – Convective heat flux in cgs units (e.g. sigma T^4). This will be used to compute
the kzz using the methodology of Gierasch and Conrath (1985)</p></li>
<li><p><strong>latent_heat</strong> (<em>bool</em>) – optional, Default = False. The latent heat factors into the mixing length.
When False, the mixing length goes as the scale height
When True, the mixing length is scaled by the latent heat
This is ONLY used when a chf (convective heat flux) is supplied</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="virga.justdoit.Atmosphere.ptk">
<code class="sig-name descname">ptk</code><span class="sig-paren">(</span><em class="sig-param">df=None</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">kz_min=100000.0</em>, <em class="sig-param">constant_kz=None</em>, <em class="sig-param">latent_heat=False</em>, <em class="sig-param">convective_overshoot=None</em>, <em class="sig-param">Teff=None</em>, <em class="sig-param">alpha_pressure=None</em>, <em class="sig-param">**pd_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.Atmosphere.ptk" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in file or define dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>dataframe</em><em> or </em><em>dict</em>) – Dataframe with “pressure”(bars),”temperature”(K). MUST have at least two
columns with names “pressure” and “temperature”.
Optional columns include the eddy diffusion “kz” in cm^2/s CGS units, and
the convective heat flux ‘chf’ also in cgs (e.g. sigma_csg T^4)</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Filename read in. Will be read in with pd.read_csv and should
result in two named headers “pressure”(bars),”temperature”(K).
Optional columns include the eddy diffusion “kz” in cm^2/s CGS units, and
the convective heat flux ‘chf’ also in cgs (e.g. sigma_csg T^4)
Use pd_kwargs to ensure file is read in properly.</p></li>
<li><p><strong>kz_min</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum Kz value. This will reset everything below kz_min to kz_min.
Default = 1e5 cm2/s</p></li>
<li><p><strong>constant_kz</strong> (<em>float</em><em>, </em><em>optional</em>) – Constant value for kz, if kz is supplied in df or filename,
it will inheret that value and not use this constant_value
Default = None</p></li>
<li><p><strong>latent_heat</strong> (<em>bool</em>) – optional, Default = False. The latent heat factors into the mixing length.
When False, the mixing length goes as the scale height
When True, the mixing length is scaled by the latent heat</p></li>
<li><p><strong>convective_overshoot</strong> (<em>float</em>) – Optional, Default is None. But the default value used in
Ackerman &amp; Marley 2001 is 1./3. If you are unsure of what to pick, start
there. This is only used when the
This is ONLY used when a chf (convective heat flux) is supplied</p></li>
<li><p><strong>Teff</strong> (<em>float</em><em>, </em><em>optional</em>) – Effective temperature. If None (default), Teff set to temperature at 1 bar</p></li>
<li><p><strong>alpha_pressure</strong> (<em>float</em>) – Pressure at which we want fsed=alpha for variable fsed calculation</p></li>
<li><p><strong>pd_kwargs</strong> (<em>kwargs</em>) – Pandas key words for file read in.
If reading old style eddysed files, you would need:
skiprows=3, delim_whitespace=True, header=None, names=[“ind”,”pressure”,”temperature”,”kz”]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="virga.justdoit.available">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">available</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.available" title="Permalink to this definition">¶</a></dt>
<dd><p>Print all available gas condensates</p>
</dd></dl>

<dl class="function">
<dt id="virga.justdoit.brown_dwarf">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">brown_dwarf</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.brown_dwarf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="virga.justdoit.calc_mie_db">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">calc_mie_db</code><span class="sig-paren">(</span><em class="sig-param">gas_name</em>, <em class="sig-param">dir_refrind</em>, <em class="sig-param">dir_out</em>, <em class="sig-param">rmin=1e-08</em>, <em class="sig-param">nradii=60</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.calc_mie_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that calculations new Mie database using PyMieScatt.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gas_name</strong> (<em>list</em><em>, </em><em>str</em>) – List of names of gasses. Or a single gas name.
See pyeddy.available() to see which ones are currently available.</p></li>
<li><p><strong>dir_refrind</strong> (<em>str</em>) – Directory where you store optical refractive index files that will be created.</p></li>
<li><p><strong>dir_out</strong> (<em>str</em>) – Directory where you want to store Mie parameter files. Will be stored as gas_name.Mieff.
BEWARE FILE OVERWRITES.</p></li>
<li><p><strong>rmin</strong> (<em>float</em><em> , </em><em>optional</em>) – (Default=1e-5) Units of cm. The minimum radius to compute Mie parameters for.
Usually 0.1 microns is small enough. However, if you notice your mean particle radius
is on the low end, you may compute your grid to even lower particle sizes.</p></li>
<li><p><strong>nradii</strong> (<em>int</em><em>, </em><em>optional</em>) – (Default=40) number of radii points to compute grid on. 40 grid points for exoplanets/BDs
is generally sufficient.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Q extinction, Q scattering,  asymmetry * Q scattering, radius grid (cm), wavelength grid (um)</em></p></li>
<li><p><em>The Q “efficiency factors” are = cross section / geometric cross section of particle</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justdoit.calc_optics">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">calc_optics</code><span class="sig-paren">(</span><em class="sig-param">nwave</em>, <em class="sig-param">qc</em>, <em class="sig-param">qt</em>, <em class="sig-param">rg</em>, <em class="sig-param">reff</em>, <em class="sig-param">ndz</em>, <em class="sig-param">radius</em>, <em class="sig-param">dr</em>, <em class="sig-param">qext</em>, <em class="sig-param">qscat</em>, <em class="sig-param">cos_qscat</em>, <em class="sig-param">sig</em>, <em class="sig-param">rmin</em>, <em class="sig-param">nrad</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.calc_optics" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate spectrally-resolved profiles of optical depth, single-scattering
albedo, and asymmetry parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwave</strong> (<em>int</em>) – Number of wave points</p></li>
<li><p><strong>qc</strong> (<em>ndarray</em>) – Condensate mixing ratio</p></li>
<li><p><strong>qt</strong> (<em>ndarray</em>) – Gas + condensate mixing ratio</p></li>
<li><p><strong>rg</strong> (<em>ndarray</em>) – Geometric mean radius of condensate</p></li>
<li><p><strong>reff</strong> (<em>ndarray</em>) – Effective (area-weighted) radius of condensate (cm)</p></li>
<li><p><strong>ndz</strong> (<em>ndarray</em>) – Column density of particle concentration in layer (#/cm^2)</p></li>
<li><p><strong>radius</strong> (<em>ndarray</em>) – Radius bin centers (cm)</p></li>
<li><p><strong>dr</strong> (<em>ndarray</em>) – Width of radius bins (cm)</p></li>
<li><p><strong>qscat</strong> (<em>ndarray</em>) – Scattering efficiency</p></li>
<li><p><strong>qext</strong> (<em>ndarray</em>) – Extinction efficiency</p></li>
<li><p><strong>cos_qscat</strong> (<em>ndarray</em>) – qscat-weighted &lt;cos (scattering angle)&gt;</p></li>
<li><p><strong>sig</strong> (<em>float</em>) – Width of the log normal particle distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>opd</strong> (<em>ndarray</em>) – extinction optical depth due to all condensates in layer</p></li>
<li><p><strong>w0</strong> (<em>ndarray</em>) – single scattering albedo</p></li>
<li><p><strong>g0</strong> (<em>ndarray</em>) – asymmetry parameter = Q_scat wtd avg of &lt;cos theta&gt;</p></li>
<li><p><strong>opd_gas</strong> (<em>ndarray</em>) – cumulative (from top) opd by condensing vapor as geometric conservative scatterers</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justdoit.calc_qc">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">calc_qc</code><span class="sig-paren">(</span><em class="sig-param">gas_name</em>, <em class="sig-param">supsat</em>, <em class="sig-param">t_layer</em>, <em class="sig-param">p_layer</em>, <em class="sig-param">r_atmos</em>, <em class="sig-param">r_cloud</em>, <em class="sig-param">q_below</em>, <em class="sig-param">mixl</em>, <em class="sig-param">dz_layer</em>, <em class="sig-param">gravity</em>, <em class="sig-param">mw_atmos</em>, <em class="sig-param">mfp</em>, <em class="sig-param">visc</em>, <em class="sig-param">rho_p</em>, <em class="sig-param">w_convect</em>, <em class="sig-param">fsed</em>, <em class="sig-param">b</em>, <em class="sig-param">eps</em>, <em class="sig-param">param</em>, <em class="sig-param">z_bot</em>, <em class="sig-param">z_layer</em>, <em class="sig-param">z_alpha</em>, <em class="sig-param">z_min</em>, <em class="sig-param">sig</em>, <em class="sig-param">mh</em>, <em class="sig-param">rmin</em>, <em class="sig-param">nrad</em>, <em class="sig-param">og_vfall=True</em>, <em class="sig-param">z_cld=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.calc_qc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate condensate optical depth and effective radius for a layer,
assuming geometric scatterers.</p>
<dl class="simple">
<dt>gas_name<span class="classifier">str</span></dt><dd><p>Name of condensate</p>
</dd>
<dt>supsat<span class="classifier">float</span></dt><dd><p>Super saturation factor</p>
</dd>
<dt>t_layer<span class="classifier">float</span></dt><dd><p>Temperature of layer mid-pt (K)</p>
</dd>
<dt>p_layer<span class="classifier">float</span></dt><dd><p>Pressure of layer mid-pt (dyne/cm^2)</p>
</dd>
<dt>r_atmos<span class="classifier">float</span></dt><dd><p>specific gas constant for atmosphere (erg/K/g)</p>
</dd>
<dt>r_cloud<span class="classifier">float</span></dt><dd><p>specific gas constant for cloud species (erg/K/g)</p>
</dd>
<dt>q_below<span class="classifier">float</span></dt><dd><p>total mixing ratio (vapor+condensate) below layer (g/g)</p>
</dd>
<dt>mxl<span class="classifier">float</span></dt><dd><p>convective mixing length scale (cm): no less than 1/10 scale height</p>
</dd>
<dt>dz_layer<span class="classifier">float</span></dt><dd><p>Thickness of layer cm</p>
</dd>
<dt>gravity<span class="classifier">float</span></dt><dd><p>Gravity of planet cgs</p>
</dd>
<dt>mw_atmos<span class="classifier">float</span></dt><dd><p>Molecular weight of the atmosphere</p>
</dd>
<dt>mfp<span class="classifier">float</span></dt><dd><p>atmospheric mean free path (cm)</p>
</dd>
<dt>visc<span class="classifier">float</span></dt><dd><p>atmospheric viscosity (dyne s/cm^2)</p>
</dd>
<dt>rho_p<span class="classifier">float</span></dt><dd><p>density of condensed vapor (g/cm^3)</p>
</dd>
<dt>w_convect<span class="classifier">float</span></dt><dd><p>convective velocity scale (cm/s)</p>
</dd>
<dt>fsed<span class="classifier">float</span></dt><dd><p>Sedimentation efficiency coefficient (unitless)</p>
</dd>
<dt>b<span class="classifier">float</span></dt><dd><p>Denominator of exponential in sedimentation efficiency  (if param is ‘exp’)</p>
</dd>
<dt>eps: float</dt><dd><p>Minimum value of fsed function (if param=exp)</p>
</dd>
<dt>z_bot<span class="classifier">float</span></dt><dd><p>Altitude at bottom of layer</p>
</dd>
<dt>z_layer<span class="classifier">float</span></dt><dd><p>Altitude of midpoint of layer (cm)</p>
</dd>
<dt>z_alpha<span class="classifier">float</span></dt><dd><p>Altitude at which fsed=alpha for variable fsed calculation</p>
</dd>
<dt>param<span class="classifier">str</span></dt><dd><p>fsed parameterisation
‘const’ (constant), ‘exp’ (exponential density derivation)</p>
</dd>
<dt>sig<span class="classifier">float</span></dt><dd><p>Width of the log normal particle distrubtion</p>
</dd>
<dt>mh<span class="classifier">float</span></dt><dd><p>Metallicity NON log solar (1 = 1x solar)</p>
</dd>
<dt>rmin<span class="classifier">float</span></dt><dd><p>Minium radius on grid (cm)</p>
</dd>
<dt>nrad<span class="classifier">int</span></dt><dd><p>Number of radii on Mie grid</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>qt_top</strong> (<em>float</em>) – gas + condensate mixing ratio at top of layer(g/g)</p></li>
<li><p><strong>qc_layer</strong> (<em>float</em>) – condenstate mixing ratio (g/g)</p></li>
<li><p><strong>qt_layer</strong> (<em>float</em>) – gas + condensate mixing ratio (g/g)</p></li>
<li><p><strong>rg_layer</strong> (<em>float</em>) – geometric mean radius of condensate  cm</p></li>
<li><p><strong>reff_layer</strong> (<em>float</em>) – droplet effective radius (second moment of size distrib, cm)</p></li>
<li><p><strong>ndz_layer</strong> (<em>float</em>) – number column density of condensate (cm^-3)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justdoit.compute">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">compute</code><span class="sig-paren">(</span><em class="sig-param">atmo</em>, <em class="sig-param">directory=None</em>, <em class="sig-param">as_dict=True</em>, <em class="sig-param">og_solver=True</em>, <em class="sig-param">direct_tol=1e-15</em>, <em class="sig-param">refine_TP=True</em>, <em class="sig-param">og_vfall=True</em>, <em class="sig-param">analytical_rg=True</em>, <em class="sig-param">do_virtual=True</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Top level program to run eddysed. Requires running <cite>Atmosphere</cite> class
before running this.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmo</strong> (<em>class</em>) – <cite>Atmosphere</cite> class</p></li>
<li><p><strong>directory</strong> (<em>str</em><em>, </em><em>optional</em>) – Directory string that describes where refrind files are</p></li>
<li><p><strong>as_dict</strong> (<em>bool</em><em>, </em><em>optional</em>) – Default = False. Option to view full output as dictionary</p></li>
<li><p><strong>og_solver</strong> (<em>bool</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Default=True. BETA. Contact developers before changing to False.</dt><dd><p>Option to change mmr solver (True = original eddysed, False = new direct solver)</p>
</dd>
</dl>
</p></li>
<li><p><strong>direct_tol</strong> (<em>float</em><em> , </em><em>optional</em>) – Only used if og_solver =False. Default = True.
Tolerance for direct solver</p></li>
<li><p><strong>refine_TP</strong> (<em>bool</em><em>, </em><em>optional</em>) – Only used if og_solver =False.
Option to refine temperature-pressure profile for direct solver</p></li>
<li><p><strong>og_vfall</strong> (<em>bool</em><em>, </em><em>optional</em>) – Option to use original A&amp;M or new Khan-Richardson method for finding vfall</p></li>
<li><p><strong>analytical_rg</strong> (<em>bool</em><em>, </em><em>optional</em>) – Only used if og_solver =False.
Option to use analytical expression for rg, or alternatively deduce rg from calculation
Calculation option will be most useful for future
inclusions of alternative particle size distributions</p></li>
<li><p><strong>do_virtual</strong> (<em>bool</em>) – If the user adds an upper bound pressure that is too low. There are cases where a cloud wants to
form off the grid towards higher pressures. This enables that.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>opd, w0, g0</em> – Extinction per layer, single scattering abledo, asymmetry parameter,
All are ndarrays that are nlayer by nwave</p></li>
<li><p><em>dict</em> – Dictionary output that contains full output. See tutorials for explanation of all output.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justdoit.condensation_t">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">condensation_t</code><span class="sig-paren">(</span><em class="sig-param">gas_name</em>, <em class="sig-param">mh</em>, <em class="sig-param">mmw</em>, <em class="sig-param">pressure=array([1.00000000e-06</em>, <em class="sig-param">2.63665090e-06</em>, <em class="sig-param">6.95192796e-06</em>, <em class="sig-param">1.83298071e-05</em>, <em class="sig-param">4.83293024e-05</em>, <em class="sig-param">1.27427499e-04</em>, <em class="sig-param">3.35981829e-04</em>, <em class="sig-param">8.85866790e-04</em>, <em class="sig-param">2.33572147e-03</em>, <em class="sig-param">6.15848211e-03</em>, <em class="sig-param">1.62377674e-02</em>, <em class="sig-param">4.28133240e-02</em>, <em class="sig-param">1.12883789e-01</em>, <em class="sig-param">2.97635144e-01</em>, <em class="sig-param">7.84759970e-01</em>, <em class="sig-param">2.06913808e+00</em>, <em class="sig-param">5.45559478e+00</em>, <em class="sig-param">1.43844989e+01</em>, <em class="sig-param">3.79269019e+01</em>, <em class="sig-param">1.00000000e+02])</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.condensation_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Find condensation curve for any planet given a pressure. These are computed
based on pressure vapor curves defined in pvaps.py.</p>
<p>Default is to compute condensation temperature on a pressure grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gas_name</strong> (<em>str</em>) – Name of gas, which is case sensitive. See print_available to see which
gases are available.</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – Metallicity in NOT log units. Solar =1</p></li>
<li><p><strong>mmw</strong> (<em>float</em>) – Mean molecular weight of the atmosphere. Solar = 2.2</p></li>
<li><p><strong>pressure</strong> (<em>ndarray</em><em>, </em><em>list</em><em>, </em><em>float</em><em>, </em><em>optional</em>) – Grid of pressures (bars) to compute condensation temperatures on.
Default = np.logspace(-3,2,20)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pressure (bars), condensation temperature (Kelvin)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray, ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justdoit.create_dict">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">create_dict</code><span class="sig-paren">(</span><em class="sig-param">qc</em>, <em class="sig-param">qt</em>, <em class="sig-param">rg</em>, <em class="sig-param">reff</em>, <em class="sig-param">ndz</em>, <em class="sig-param">opd</em>, <em class="sig-param">w0</em>, <em class="sig-param">g0</em>, <em class="sig-param">opd_gas</em>, <em class="sig-param">wave</em>, <em class="sig-param">pressure</em>, <em class="sig-param">temperature</em>, <em class="sig-param">gas_names</em>, <em class="sig-param">mh</em>, <em class="sig-param">mmw</em>, <em class="sig-param">fsed</em>, <em class="sig-param">sig</em>, <em class="sig-param">nrad</em>, <em class="sig-param">rmin</em>, <em class="sig-param">z</em>, <em class="sig-param">dz_layer</em>, <em class="sig-param">mixl</em>, <em class="sig-param">kz</em>, <em class="sig-param">scale_h</em>, <em class="sig-param">z_cld</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.create_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="virga.justdoit.eddysed">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">eddysed</code><span class="sig-paren">(</span><em class="sig-param">t_top</em>, <em class="sig-param">p_top</em>, <em class="sig-param">t_mid</em>, <em class="sig-param">p_mid</em>, <em class="sig-param">condensibles</em>, <em class="sig-param">gas_mw</em>, <em class="sig-param">gas_mmr</em>, <em class="sig-param">rho_p</em>, <em class="sig-param">mw_atmos</em>, <em class="sig-param">gravity</em>, <em class="sig-param">kz</em>, <em class="sig-param">mixl</em>, <em class="sig-param">fsed</em>, <em class="sig-param">b</em>, <em class="sig-param">eps</em>, <em class="sig-param">z_top</em>, <em class="sig-param">z_alpha</em>, <em class="sig-param">z_min</em>, <em class="sig-param">param</em>, <em class="sig-param">mh</em>, <em class="sig-param">sig</em>, <em class="sig-param">rmin</em>, <em class="sig-param">nrad</em>, <em class="sig-param">d_molecule</em>, <em class="sig-param">eps_k</em>, <em class="sig-param">c_p_factor</em>, <em class="sig-param">og_vfall=True</em>, <em class="sig-param">do_virtual=True</em>, <em class="sig-param">supsat=0</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.eddysed" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an atmosphere and condensates, calculate size and concentration
of condensates in balance between eddy diffusion and sedimentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_top</strong> (<em>ndarray</em>) – Temperature at each layer (K)</p></li>
<li><p><strong>p_top</strong> (<em>ndarray</em>) – Pressure at each layer (dyn/cm^2)</p></li>
<li><p><strong>t_mid</strong> (<em>ndarray</em>) – Temperature at each midpoint (K)</p></li>
<li><p><strong>p_mid</strong> (<em>ndarray</em>) – Pressure at each midpoint (dyn/cm^2)</p></li>
<li><p><strong>condensibles</strong> (<em>ndarray</em><em> or </em><em>list of str</em>) – List or array of condensible gas names</p></li>
<li><p><strong>gas_mw</strong> (<em>ndarray</em>) – Array of gas mean molecular weight from <cite>gas_properties</cite></p></li>
<li><p><strong>gas_mmr</strong> (<em>ndarray</em>) – Array of gas mixing ratio from <cite>gas_properties</cite></p></li>
<li><p><strong>rho_p</strong> (<em>float</em>) – density of condensed vapor (g/cm^3)</p></li>
<li><p><strong>mw_atmos</strong> (<em>float</em>) – Mean molecular weight of the atmosphere</p></li>
<li><p><strong>gravity</strong> (<em>float</em>) – Gravity of planet cgs</p></li>
<li><p><strong>kz</strong> (<em>float</em><em> or </em><em>ndarray</em>) – Kzz in cgs, either float or ndarray depending of whether or not
it is set as input</p></li>
<li><p><strong>fsed</strong> (<em>float</em>) – Sedimentation efficiency coefficient, unitless</p></li>
<li><p><strong>b</strong> (<em>float</em>) – Denominator of exponential in sedimentation efficiency  (if param is ‘exp’)</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – Minimum value of fsed function (if param=exp)</p></li>
<li><p><strong>z_top</strong> (<em>float</em>) – Altitude at each layer</p></li>
<li><p><strong>z_alpha</strong> (<em>float</em>) – Altitude at which fsed=alpha for variable fsed calculation</p></li>
<li><p><strong>param</strong> (<em>str</em>) – fsed parameterisation
‘const’ (constant), ‘exp’ (exponential density derivation)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – Atmospheric metallicity in NON log units (e.g. 1 for 1x solar)</p></li>
<li><p><strong>sig</strong> (<em>float</em>) – Width of the log normal particle distribution</p></li>
<li><p><strong>d_molecule</strong> (<em>float</em>) – diameter of atmospheric molecule (cm) (Rosner, 2000)
(3.711e-8 for air, 3.798e-8 for N2, 2.827e-8 for H2)
Set in Atmosphere constants</p></li>
<li><p><strong>eps_k</strong> (<em>float</em>) – Depth of the Lennard-Jones potential well for the atmosphere
Used in the viscocity calculation (units are K) (Rosner, 2000)</p></li>
<li><p><strong>c_p_factor</strong> (<em>float</em>) – specific heat of atmosphere (erg/K/g) . Usually 7/2 for ideal gas
diatomic molecules (e.g. H2, N2). Technically does slowly rise with
increasing temperature</p></li>
<li><p><strong>og_vfall</strong> (<em>bool</em><em> , </em><em>optional</em>) – optional, default = True. True does the original fall velocity calculation.
False does the updated one which runs a tad slower but is more consistent.
The main effect of turning on False is particle sizes in the upper atmosphere
that are slightly bigger.</p></li>
<li><p><strong>do_virtual</strong> (<em>bool</em><em>,</em><em>optional</em>) – optional, Default = True which adds a virtual layer if the
species condenses below the model domain.</p></li>
<li><p><strong>supsat</strong> (<em>float</em><em>, </em><em>optional</em>) – Default = 0 , Saturation factor (after condensation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>qc</strong> (<em>ndarray</em>) – condenstate mixing ratio (g/g)</p></li>
<li><p><strong>qt</strong> (<em>ndarray</em>) – gas + condensate mixing ratio (g/g)</p></li>
<li><p><strong>rg</strong> (<em>ndarray</em>) – geometric mean radius of condensate  cm</p></li>
<li><p><strong>reff</strong> (<em>ndarray</em>) – droplet effective radius (second moment of size distrib, cm)</p></li>
<li><p><strong>ndz</strong> (<em>ndarray</em>) – number column density of condensate (cm^-3)</p></li>
<li><p><strong>qc_path</strong> (<em>ndarray</em>) – vertical path of condensate</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justdoit.get_mie">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">get_mie</code><span class="sig-paren">(</span><em class="sig-param">gas</em>, <em class="sig-param">directory</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.get_mie" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Mie parameters from old ass formatted files</p>
</dd></dl>

<dl class="function">
<dt id="virga.justdoit.get_r_grid">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">get_r_grid</code><span class="sig-paren">(</span><em class="sig-param">r_min=1e-08</em>, <em class="sig-param">n_radii=60</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.get_r_grid" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Original code from A&amp;M code.
Discontinued function. See ‘get_r_grid’.</p>
<p>Get spacing of radii to run Mie code</p>
<dl class="simple">
<dt>r_min<span class="classifier">float</span></dt><dd><p>Minimum radius to compute (cm)</p>
</dd>
<dt>n_radii<span class="classifier">int</span></dt><dd><p>Number of radii to compute</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="virga.justdoit.get_r_grid_w_max">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">get_r_grid_w_max</code><span class="sig-paren">(</span><em class="sig-param">r_min=1e-08</em>, <em class="sig-param">r_max=0.054239131</em>, <em class="sig-param">n_radii=60</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.get_r_grid_w_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Get spacing of radii to run Mie code</p>
<dl class="simple">
<dt>r_min<span class="classifier">float</span></dt><dd><p>Minimum radius to compute (cm)</p>
</dd>
<dt>r_max<span class="classifier">float</span></dt><dd><p>Maximum radius to compute (cm)</p>
</dd>
<dt>n_radii<span class="classifier">int</span></dt><dd><p>Number of radii to compute</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justdoit.get_refrind">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">get_refrind</code><span class="sig-paren">(</span><em class="sig-param">igas</em>, <em class="sig-param">directory</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.get_refrind" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads reference files with wavelength, and refractory indecies.
This function relies on input files being structured as a 4 column file with
columns: index, wavelength (micron), nn, kk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>igas</strong> (<em>str</em>) – Gas name</p></li>
<li><p><strong>directory</strong> (<em>str</em>) – Directory were reference files are located.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justdoit.hot_jupiter">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">hot_jupiter</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.hot_jupiter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="virga.justdoit.layer">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">layer</code><span class="sig-paren">(</span><em class="sig-param">gas_name</em>, <em class="sig-param">rho_p</em>, <em class="sig-param">t_layer</em>, <em class="sig-param">p_layer</em>, <em class="sig-param">t_top</em>, <em class="sig-param">t_bot</em>, <em class="sig-param">p_top</em>, <em class="sig-param">p_bot</em>, <em class="sig-param">kz</em>, <em class="sig-param">mixl</em>, <em class="sig-param">gravity</em>, <em class="sig-param">mw_atmos</em>, <em class="sig-param">gas_mw</em>, <em class="sig-param">q_below</em>, <em class="sig-param">supsat</em>, <em class="sig-param">fsed</em>, <em class="sig-param">b</em>, <em class="sig-param">eps</em>, <em class="sig-param">z_top</em>, <em class="sig-param">z_bot</em>, <em class="sig-param">z_alpha</em>, <em class="sig-param">z_min</em>, <em class="sig-param">param</em>, <em class="sig-param">sig</em>, <em class="sig-param">mh</em>, <em class="sig-param">rmin</em>, <em class="sig-param">nrad</em>, <em class="sig-param">d_molecule</em>, <em class="sig-param">eps_k</em>, <em class="sig-param">c_p_factor</em>, <em class="sig-param">og_vfall</em>, <em class="sig-param">z_cld</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate layer condensate properties by iterating on optical depth
in one model layer (convering on optical depth over sublayers)</p>
<dl class="simple">
<dt>gas_name<span class="classifier">str</span></dt><dd><p>Name of condenstante</p>
</dd>
<dt>rho_p<span class="classifier">float</span></dt><dd><p>density of condensed vapor (g/cm^3)</p>
</dd>
<dt>t_layer<span class="classifier">float</span></dt><dd><p>Temperature of layer mid-pt (K)</p>
</dd>
<dt>p_layer<span class="classifier">float</span></dt><dd><p>Pressure of layer mid-pt (dyne/cm^2)</p>
</dd>
<dt>t_top<span class="classifier">float</span></dt><dd><p>Temperature at top of layer (K)</p>
</dd>
<dt>t_bot<span class="classifier">float</span></dt><dd><p>Temperature at botton of layer (K)</p>
</dd>
<dt>p_top<span class="classifier">float</span></dt><dd><p>Pressure at top of layer (dyne/cm2)</p>
</dd>
<dt>p_bot<span class="classifier">float</span></dt><dd><p>Pressure at botton of layer</p>
</dd>
<dt>kz<span class="classifier">float</span></dt><dd><p>eddy diffusion coefficient (cm^2/s)</p>
</dd>
<dt>mixl<span class="classifier">float</span></dt><dd><p>Mixing length (cm)</p>
</dd>
<dt>gravity<span class="classifier">float</span></dt><dd><p>Gravity of planet cgs</p>
</dd>
<dt>mw_atmos<span class="classifier">float</span></dt><dd><p>Molecular weight of the atmosphere</p>
</dd>
<dt>gas_mw<span class="classifier">float</span></dt><dd><p>Gas molecular weight</p>
</dd>
<dt>q_below<span class="classifier">float</span></dt><dd><p>total mixing ratio (vapor+condensate) below layer (g/g)</p>
</dd>
<dt>supsat<span class="classifier">float</span></dt><dd><p>Super saturation factor</p>
</dd>
<dt>fsed<span class="classifier">float</span></dt><dd><p>Sedimentation efficiency coefficient (unitless)</p>
</dd>
<dt>b<span class="classifier">float</span></dt><dd><p>Denominator of exponential in sedimentation efficiency  (if param is ‘exp’)</p>
</dd>
<dt>eps: float</dt><dd><p>Minimum value of fsed function (if param=exp)</p>
</dd>
<dt>z_top<span class="classifier">float</span></dt><dd><p>Altitude at top of layer</p>
</dd>
<dt>z_bot<span class="classifier">float</span></dt><dd><p>Altitude at bottom of layer</p>
</dd>
<dt>z_alpha<span class="classifier">float</span></dt><dd><p>Altitude at which fsed=alpha for variable fsed calculation</p>
</dd>
<dt>param<span class="classifier">str</span></dt><dd><p>fsed parameterisation
‘const’ (constant), ‘exp’ (exponential density derivation)</p>
</dd>
<dt>sig<span class="classifier">float</span></dt><dd><p>Width of the log normal particle distribution</p>
</dd>
<dt>mh<span class="classifier">float</span></dt><dd><p>Metallicity NON log soar (1=1xSolar)</p>
</dd>
<dt>rmin<span class="classifier">float</span></dt><dd><p>Minium radius on grid (cm)</p>
</dd>
<dt>nrad<span class="classifier">int</span></dt><dd><p>Number of radii on Mie grid</p>
</dd>
<dt>d_molecule<span class="classifier">float</span></dt><dd><p>diameter of atmospheric molecule (cm) (Rosner, 2000)
(3.711e-8 for air, 3.798e-8 for N2, 2.827e-8 for H2)
Set in Atmosphere constants</p>
</dd>
<dt>eps_k<span class="classifier">float</span></dt><dd><p>Depth of the Lennard-Jones potential well for the atmosphere
Used in the viscocity calculation (units are K) (Rosner, 2000)</p>
</dd>
<dt>c_p_factor<span class="classifier">float</span></dt><dd><p>specific heat of atmosphere (erg/K/g) . Usually 7/2 for ideal gas
diatomic molecules (e.g. H2, N2). Technically does slowly rise with
increasing temperature</p>
</dd>
<dt>og_vfall<span class="classifier">bool</span></dt><dd><p>Use original or new vfall calculation</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>qc_layer</strong> (<em>ndarray</em>) – condenstate mixing ratio (g/g)</p></li>
<li><p><strong>qt_layer</strong> (<em>ndarray</em>) – gas + condensate mixing ratio (g/g)</p></li>
<li><p><strong>rg_layer</strong> (<em>ndarray</em>) – geometric mean radius of condensate  cm</p></li>
<li><p><strong>reff_layer</strong> (<em>ndarray</em>) – droplet effective radius (second moment of size distrib, cm)</p></li>
<li><p><strong>ndz_layer</strong> (<em>ndarray</em>) – number column density of condensate (cm^-3)</p></li>
<li><p><strong>q_below</strong> (<em>ndarray</em>) – total mixing ratio (vapor+condensate) below layer (g/g)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justdoit.picaso_format">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">picaso_format</code><span class="sig-paren">(</span><em class="sig-param">opd</em>, <em class="sig-param">w0</em>, <em class="sig-param">g0</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.picaso_format" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="virga.justdoit.recommend_gas">
<code class="sig-prename descclassname">virga.justdoit.</code><code class="sig-name descname">recommend_gas</code><span class="sig-paren">(</span><em class="sig-param">pressure</em>, <em class="sig-param">temperature</em>, <em class="sig-param">mh</em>, <em class="sig-param">mmw</em>, <em class="sig-param">plot=False</em>, <em class="sig-param">legend='inside'</em>, <em class="sig-param">**plot_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justdoit.recommend_gas" title="Permalink to this definition">¶</a></dt>
<dd><p>Recommends condensate species for a users calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pressure</strong> (<em>ndarray</em><em>, </em><em>list</em>) – Pressure grid for user’s pressure-temperature profile. Unit=bars</p></li>
<li><p><strong>temperature</strong> (<em>ndarray</em><em>, </em><em>list</em>) – Temperature grid (should be on same grid as pressure input). Unit=Kelvin</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – Metallicity in NOT log units. Solar =1</p></li>
<li><p><strong>mmw</strong> (<em>float</em>) – Mean molecular weight of the atmosphere. Solar = 2.2</p></li>
<li><p><strong>plot</strong> (<em>bool</em><em>, </em><em>optional</em>) – Default is False. Plots condensation curves against PT profile to
demonstrate why it has chose the gases it did.</p></li>
<li><p><strong>plot_kwargs</strong> (<em>kwargs</em>) – Plotting kwargs for bokeh figure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pressure (bars), condensation temperature (Kelvin)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray, ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-virga.justplotit">
<span id="virga-justplotit-module"></span><h2>virga.justplotit module<a class="headerlink" href="#module-virga.justplotit" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="virga.justplotit.all_optics">
<code class="sig-prename descclassname">virga.justplotit.</code><code class="sig-name descname">all_optics</code><span class="sig-paren">(</span><em class="sig-param">out</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.all_optics" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps of the wavelength dependent single scattering albedo
and cloud opacity and asymmetry parameter as a function of altitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>out</strong> (<em>dict</em>) – Dictionary output from pyeddy run</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Three bokeh plots with the single scattering, optical depth, and assymetry maps</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justplotit.all_optics_1d">
<code class="sig-prename descclassname">virga.justplotit.</code><code class="sig-name descname">all_optics_1d</code><span class="sig-paren">(</span><em class="sig-param">out, wave_range, return_output=False, legend=None, colors=['#0072B2', '#E69F00', '#F0E442', '#009E73', '#56B4E9', '#D55E00', '#CC79A7', '#000000'], **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.all_optics_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots 1d profiles of optical depth per layer, single scattering, and
asymmetry averaged over the user input wave_range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>list</em><em> or </em><em>dict</em>) – Either a list of output dictionaries or a single dictionary output
from .compute(as_dict=True)</p></li>
<li><p><strong>wave_range</strong> (<em>list</em>) – min and max wavelength in microns</p></li>
<li><p><strong>return_output</strong> (<em>bool</em>) – Default is just to return a figure but you can also
return all the 1d profiles</p></li>
<li><p><strong>legend</strong> (<em>bool</em>) – Default is none. Legend for each component of out</p></li>
<li><p><strong>**kwargs</strong> (<em>keyword arguments</em>) – Key word arguments will be supplied to each bokeh figure function</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justplotit.condensate_mmr">
<code class="sig-prename descclassname">virga.justplotit.</code><code class="sig-name descname">condensate_mmr</code><span class="sig-paren">(</span><em class="sig-param">out</em>, <em class="sig-param">gas=None</em>, <em class="sig-param">compare=False</em>, <em class="sig-param">legend=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.condensate_mmr" title="Permalink to this definition">¶</a></dt>
<dd><p>Condensate mean mass mixing ratio</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>dict</em>) – Dictionary output from pyeddy run</p></li>
<li><p><strong>color</strong> (<em>method</em>) – Method from bokeh.palletes. e.g. bokeh.palletes.virids, bokeh.palletes.magma</p></li>
<li><p><strong>**kwargs</strong> (<em>kwargs</em>) – Kwargs for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justplotit.find_nearest_1d">
<code class="sig-prename descclassname">virga.justplotit.</code><code class="sig-name descname">find_nearest_1d</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.find_nearest_1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="virga.justplotit.fsed_from_output">
<code class="sig-prename descclassname">virga.justplotit.</code><code class="sig-name descname">fsed_from_output</code><span class="sig-paren">(</span><em class="sig-param">out</em>, <em class="sig-param">labels</em>, <em class="sig-param">y_axis='pressure'</em>, <em class="sig-param">color_indx=0</em>, <em class="sig-param">cld_bounds=False</em>, <em class="sig-param">gas_indx=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.fsed_from_output" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="virga.justplotit.opd_by_gas">
<code class="sig-prename descclassname">virga.justplotit.</code><code class="sig-name descname">opd_by_gas</code><span class="sig-paren">(</span><em class="sig-param">out</em>, <em class="sig-param">gas=None</em>, <em class="sig-param">color=&lt;bound method _PalettesModule.magma of &lt;module 'bokeh.palettes'&gt;&gt;</em>, <em class="sig-param">compare=False</em>, <em class="sig-param">legend=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.opd_by_gas" title="Permalink to this definition">¶</a></dt>
<dd><p>Optical depth for conservative geometric scatteres separated by gas.
E.g. [Fig 7 in Morley+2012](<a class="reference external" href="https://arxiv.org/pdf/1206.4313.pdf">https://arxiv.org/pdf/1206.4313.pdf</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>dict</em>) – Dictionary output from pyeddy run</p></li>
<li><p><strong>color</strong> (<em>method</em>) – Method from bokeh.palletes. e.g. bokeh.palletes.virids, bokeh.palletes.magma</p></li>
<li><p><strong>**kwargs</strong> (<em>kwargs</em>) – Kwargs for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justplotit.plot_format">
<code class="sig-prename descclassname">virga.justplotit.</code><code class="sig-name descname">plot_format</code><span class="sig-paren">(</span><em class="sig-param">df</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.plot_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to reformat plots</p>
</dd></dl>

<dl class="function">
<dt id="virga.justplotit.plot_fsed">
<code class="sig-prename descclassname">virga.justplotit.</code><code class="sig-name descname">plot_fsed</code><span class="sig-paren">(</span><em class="sig-param">pressure</em>, <em class="sig-param">z</em>, <em class="sig-param">scale_height</em>, <em class="sig-param">alpha</em>, <em class="sig-param">beta</em>, <em class="sig-param">epsilon=0.01</em>, <em class="sig-param">pres_alpha=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.plot_fsed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="virga.justplotit.pressure_fig">
<code class="sig-prename descclassname">virga.justplotit.</code><code class="sig-name descname">pressure_fig</code><span class="sig-paren">(</span><em class="sig-param">**plot_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.pressure_fig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="virga.justplotit.pt">
<code class="sig-prename descclassname">virga.justplotit.</code><code class="sig-name descname">pt</code><span class="sig-paren">(</span><em class="sig-param">out</em>, <em class="sig-param">with_condensation=True</em>, <em class="sig-param">return_condensation=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot PT profiles with condensation curves.
Thick lines in this pt plot signify those gases that
were turned on in the run, NOT those that were recommended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>dict</em>) – Dictionary output from pyeddy run</p></li>
<li><p><strong>with_condensation</strong> (<em>bool</em>) – Plots condensation curves of gases. Also plots those that were turned on in the
calculation with line_width=5. All others are set to 1.</p></li>
<li><p><strong>return_condensation</strong> (<em>bool</em>) – If true, it returns list of condenation temps for each gas, pressure grid,
and a list of the gas names</p></li>
<li><p><strong>**kwargs</strong> (<em>kwargs</em>) – Kwargs for bokeh.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>if return_condensation</strong> (<em>fig, cond temperature curves, ,cond pressure grid , name of all available gases</em>)</p></li>
<li><p><strong>else</strong> (<em>fig</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.justplotit.radii">
<code class="sig-prename descclassname">virga.justplotit.</code><code class="sig-name descname">radii</code><span class="sig-paren">(</span><em class="sig-param">out</em>, <em class="sig-param">gas=None</em>, <em class="sig-param">at_pressure=0.001</em>, <em class="sig-param">compare=False</em>, <em class="sig-param">legend=None</em>, <em class="sig-param">p1w=300</em>, <em class="sig-param">p1h=300</em>, <em class="sig-param">p2w=300</em>, <em class="sig-param">p2h=300</em>, <em class="sig-param">color_indx=0</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.justplotit.radii" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the particle radii profile along with the distribution, at a certain pressure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>dict</em>) – Dictionary output from pyeddy run</p></li>
<li><p><strong>pressure</strong> (<em>float</em><em>,</em><em>optional</em>) – Pressure level to plot full distribution (bars)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-virga.optics">
<span id="virga-optics-module"></span><h2>virga.optics module<a class="headerlink" href="#module-virga.optics" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="virga.optics.get_refrind">
<code class="sig-prename descclassname">virga.optics.</code><code class="sig-name descname">get_refrind</code><span class="sig-paren">(</span><em class="sig-param">condensible</em>, <em class="sig-param">directory='~/Documents/eddysed/input/optics'</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.optics.get_refrind" title="Permalink to this definition">¶</a></dt>
<dd><p>Read old style refrind files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>condensible</strong> (<em>str</em>) – Condensible name (e.g. Al2O3)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>micron_wave, nn, kk as ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.optics.init_optics">
<code class="sig-prename descclassname">virga.optics.</code><code class="sig-name descname">init_optics</code><span class="sig-paren">(</span><em class="sig-param">condensibles</em>, <em class="sig-param">nrad=40</em>, <em class="sig-param">rmin=1e-10</em>, <em class="sig-param">read_mie=True</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.optics.init_optics" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup up a particle size grid and calculate single-particle scattering
and absorption efficiencies and other parameters to be used by
<cite>calc_optics()</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>do_optics</strong> (<em>bool</em>) – (True/False) Calculate optics (T) or use pre computed files (F)</p></li>
<li><p><strong>read_mie</strong> (<em>bool</em>) – (True/False) Read in Mie coefficients from pre compute files <cite>gas_name.mieff</cite></p></li>
<li><p><strong>condensibles</strong> (<em>list of str</em>) – Name in str of all condensible gases e.g. [‘H2O’,’CH4’]</p></li>
<li><p><strong>nrad</strong> (<em>int</em>) – Number of radius grid points</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – Minimum number of radius grid (cm)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>wave</strong> (<em>array</em>) – Wavelength bin centers (cm)</p></li>
<li><p><strong>radius</strong> (<em>array</em>) – Radius bin centers (cm)</p></li>
<li><p><strong>dr</strong> (<em>array</em>) – Widths of radius bins (cm)</p></li>
<li><p><strong>qscat</strong> (<em>array</em>) – Scattering efficiency</p></li>
<li><p><strong>qext</strong> (<em>array</em>) – Extinction efficiency</p></li>
<li><p><strong>cos_qscat</strong> (<em>array</em>) – qscat * acerage &lt;cos (scattering angle)&gt;</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-virga.pvaps">
<span id="virga-pvaps-module"></span><h2>virga.pvaps module<a class="headerlink" href="#module-virga.pvaps" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="virga.pvaps.Al2O3">
<code class="sig-prename descclassname">virga.pvaps.</code><code class="sig-name descname">Al2O3</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">mh=1</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.Al2O3" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.pvaps.CH4">
<code class="sig-prename descclassname">virga.pvaps.</code><code class="sig-name descname">CH4</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">mh=1</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.CH4" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.pvaps.Cr">
<code class="sig-prename descclassname">virga.pvaps.</code><code class="sig-name descname">Cr</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">mh=1</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.Cr" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.pvaps.Fe">
<code class="sig-prename descclassname">virga.pvaps.</code><code class="sig-name descname">Fe</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">mh=1</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.Fe" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.pvaps.H2O">
<code class="sig-prename descclassname">virga.pvaps.</code><code class="sig-name descname">H2O</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">do_buck=True</em>, <em class="sig-param">mh=1</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.H2O" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
<li><p><strong>do_buck</strong> (<em>bool</em>) – True means use Buck 1981 expresssion, False means use
Wexler’s</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.pvaps.KCl">
<code class="sig-prename descclassname">virga.pvaps.</code><code class="sig-name descname">KCl</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">mh=1</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.KCl" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.pvaps.Mg2SiO4">
<code class="sig-prename descclassname">virga.pvaps.</code><code class="sig-name descname">Mg2SiO4</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">p</em>, <em class="sig-param">mh=1</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.Mg2SiO4" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.pvaps.MgSiO3">
<code class="sig-prename descclassname">virga.pvaps.</code><code class="sig-name descname">MgSiO3</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">mh=1</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.MgSiO3" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.pvaps.MnS">
<code class="sig-prename descclassname">virga.pvaps.</code><code class="sig-name descname">MnS</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">mh=1</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.MnS" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.pvaps.NH3">
<code class="sig-prename descclassname">virga.pvaps.</code><code class="sig-name descname">NH3</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">mh=1</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.NH3" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.pvaps.Na2S">
<code class="sig-prename descclassname">virga.pvaps.</code><code class="sig-name descname">Na2S</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">mh=1</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.Na2S" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.pvaps.TiO2">
<code class="sig-prename descclassname">virga.pvaps.</code><code class="sig-name descname">TiO2</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">mh=1</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.TiO2" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.pvaps.ZnS">
<code class="sig-prename descclassname">virga.pvaps.</code><code class="sig-name descname">ZnS</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">mh=1</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.pvaps.ZnS" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes vapor pressure curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em><em>, </em><em>ndarray</em>) – Temperature (K)</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log metallicity relative to solar (1=1Xsolar)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vapor pressure in dyne/cm^2</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-virga.root_functions">
<span id="virga-roo-functions-module"></span><h2>virga.roo_functions module<a class="headerlink" href="#module-virga.root_functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="virga.root_functions.advdiff">
<code class="sig-prename descclassname">virga.root_functions.</code><code class="sig-name descname">advdiff</code><span class="sig-paren">(</span><em class="sig-param">qt</em>, <em class="sig-param">ad_qbelow=None</em>, <em class="sig-param">ad_qvs=None</em>, <em class="sig-param">ad_mixl=None</em>, <em class="sig-param">ad_dz=None</em>, <em class="sig-param">ad_rainf=None</em>, <em class="sig-param">zb=None</em>, <em class="sig-param">b=None</em>, <em class="sig-param">eps=None</em>, <em class="sig-param">param='const'</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.advdiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate divergence from advective-diffusive balance for
condensate in a model layer</p>
<p>All units are cgs</p>
<ol class="upperalpha simple">
<li><p>Ackerman Feb-2000</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qt</strong> (<em>float</em>) – total mixing ratio of condensate + vapor (g/g)</p></li>
<li><p><strong>ad_qbelow</strong> (<em>float</em>) – total mixing ratio of vapor in underlying layer (g/g)</p></li>
<li><p><strong>ad_qvs</strong> (<em>float</em>) – saturation mixing ratio (g/g)</p></li>
<li><p><strong>ad_mixl</strong> (<em>float</em>) – convective mixing length (cm)</p></li>
<li><p><strong>ad_dz</strong> (<em>float</em>) – layer thickness (cm)</p></li>
<li><p><strong>ad_rainf</strong> (<em>float</em>) – rain efficiency factor</p></li>
<li><p><strong>zb</strong> (<em>float</em>) – altitude at bottom of layer</p></li>
<li><p><strong>b</strong> (<em>float</em>) – denominator of fsed exponential (if param is ‘exp’)</p></li>
<li><p><strong>param</strong> (<em>str</em>) – fsed parameterisation
‘const’ (constant), ‘exp’ (exponential density derivation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ad_qc</strong> – mixing ratio of condensed condensate (g/g)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.root_functions.find_cond_t">
<code class="sig-prename descclassname">virga.root_functions.</code><code class="sig-name descname">find_cond_t</code><span class="sig-paren">(</span><em class="sig-param">t_test</em>, <em class="sig-param">p_test=None</em>, <em class="sig-param">mh=None</em>, <em class="sig-param">mmw=None</em>, <em class="sig-param">gas_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.find_cond_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Root function used used to find condenstation temperature. E.g.
the temperature when</p>
<p>log p_vap = log partial pressure of gas</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_test</strong> (<em>float</em>) – Temp (K)</p></li>
<li><p><strong>p_test</strong> (<em>float</em>) – Pressure bars</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – NON log mh .. aka MH=1 for solar</p></li>
<li><p><strong>mmw</strong> (<em>float</em>) – mean molecular weight (2.2 for solar)</p></li>
<li><p><strong>gas_name</strong> (<em>str</em>) – gas name, case sensitive</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.root_functions.find_rg">
<code class="sig-prename descclassname">virga.root_functions.</code><code class="sig-name descname">find_rg</code><span class="sig-paren">(</span><em class="sig-param">rg</em>, <em class="sig-param">fsed</em>, <em class="sig-param">rw</em>, <em class="sig-param">alpha</em>, <em class="sig-param">s</em>, <em class="sig-param">loc=0.0</em>, <em class="sig-param">dist='lognormal'</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.find_rg" title="Permalink to this definition">¶</a></dt>
<dd><p>Root function used used to find the geometric mean radius of
lognormal size distribution.</p>
<p>Useful if we consider more complicated size distributions for which
analytical expressions for moments are not easily obtained.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rg</strong> (<em>float</em>) – Geometric mean radius</p></li>
<li><p><strong>fsed</strong> (<em>float</em>) – Sedimentation efficiency</p></li>
<li><p><strong>rw</strong> (<em>float</em>) – Fall velocity particle radius</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Exponent in power-law approximation for particle fall-speed</p></li>
<li><p><strong>s</strong> (<em>float</em>) – s = log(sigma) where sigma is the geometric std dev of lognormal distn</p></li>
<li><p><strong>loc</strong> (<em>float</em>) – Shift in lognormal distribution</p></li>
<li><p><strong>dist</strong> (<em>str</em>) – Continuous random variable for particle size distribution</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.root_functions.force_balance">
<code class="sig-prename descclassname">virga.root_functions.</code><code class="sig-name descname">force_balance</code><span class="sig-paren">(</span><em class="sig-param">vf</em>, <em class="sig-param">r</em>, <em class="sig-param">grav</em>, <em class="sig-param">mw_atmos</em>, <em class="sig-param">mfp</em>, <em class="sig-param">visc</em>, <em class="sig-param">t</em>, <em class="sig-param">p</em>, <em class="sig-param">rhop</em>, <em class="sig-param">gas_kinetics=True</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.force_balance" title="Permalink to this definition">¶</a></dt>
<dd><p>”
Define force balance for spherical particles falling in atmosphere, namely equate
gravitational and viscous drag forces.</p>
<p>Viscous drag assumed to be quadratic (Benchaita et al. 1983) and is a function of
the Reynolds number dependent drag coefficient.
Drag coefficient taken from Khan-Richardson model (Richardson et al. 2002) and
is valid for 1e-2 &lt; Re &lt; 1e5.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vf</strong> (<em>float</em>) – particle sedimentation velocity (cm/s)</p></li>
<li><p><strong>r</strong> (<em>float</em>) – particle radius (cm)</p></li>
<li><p><strong>grav</strong> (<em>float</em>) – acceleration of gravity (cm/s^2)</p></li>
<li><p><strong>mw_atmos</strong> (<em>float</em>) – atmospheric molecular weight (g/mol)</p></li>
<li><p><strong>mfp</strong> (<em>float</em>) – atmospheric molecular mean free path (cm)</p></li>
<li><p><strong>visc</strong> (<em>float</em>) – atmospheric dynamic viscosity (dyne s/cm^2) see Eqn. B2 in A&amp;M</p></li>
<li><p><strong>t</strong> (<em>float</em>) – atmospheric temperature (K)</p></li>
<li><p><strong>p</strong> (<em>float</em>) – atmospheric pressure (dyne/cm^2)</p></li>
<li><p><strong>rhop</strong> (<em>float</em>) – density of particle (g/cm^3)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.root_functions.moment">
<code class="sig-prename descclassname">virga.root_functions.</code><code class="sig-name descname">moment</code><span class="sig-paren">(</span><em class="sig-param">n</em>, <em class="sig-param">s</em>, <em class="sig-param">loc</em>, <em class="sig-param">scale</em>, <em class="sig-param">dist='lognormal'</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.moment" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate moment of size distribution.
Will be extended to include more than just lognormal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>float</em>) – nth moment to be calculated</p></li>
<li><p><strong>s</strong> (<em>float</em>) – std dev</p></li>
<li><p><strong>loc</strong> (<em>float</em>) – Shift in distribution</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – Scale distribution</p></li>
<li><p><strong>dist</strong> (<em>str</em>) – Continuous random variable for particle size distribution</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>moment_out</strong> – nth moment of distribution</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.root_functions.qvs_below_model">
<code class="sig-prename descclassname">virga.root_functions.</code><code class="sig-name descname">qvs_below_model</code><span class="sig-paren">(</span><em class="sig-param">p_test</em>, <em class="sig-param">qv_dtdlnp=None</em>, <em class="sig-param">qv_p=None</em>, <em class="sig-param">qv_t=None</em>, <em class="sig-param">qv_factor=None</em>, <em class="sig-param">qv_gas_name=None</em>, <em class="sig-param">mh=None</em>, <em class="sig-param">q_below=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.qvs_below_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the pressure of saturation mixing ratio for a gas
that is extrapolated below the model domain.
This is specifically used if the gas has saturated
below the model grid</p>
</dd></dl>

<dl class="function">
<dt id="virga.root_functions.solve_force_balance">
<code class="sig-prename descclassname">virga.root_functions.</code><code class="sig-name descname">solve_force_balance</code><span class="sig-paren">(</span><em class="sig-param">solve_for</em>, <em class="sig-param">temp</em>, <em class="sig-param">grav</em>, <em class="sig-param">mw_atmos</em>, <em class="sig-param">mfp</em>, <em class="sig-param">visc</em>, <em class="sig-param">t</em>, <em class="sig-param">p</em>, <em class="sig-param">rhop</em>, <em class="sig-param">lo</em>, <em class="sig-param">hi</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.solve_force_balance" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>This can be used to equate gravitational and viscous drag forces to find either</dt><dd><ol class="loweralpha simple">
<li><p>fallspeed for a spherical particle of given radius, or</p></li>
<li><p>the radius of a particle falling with a particular speed</p></li>
</ol>
</dd>
</dl>
<p>at one layer in an atmosphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solve_for</strong> (<em>str</em>) – property we are solving force balance for
either “vfall” or “rw”</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – <p>the other property needed to solve the force balance for solve_for
ie if solve_for=”vfall”, temp will be a radius (cm)</p>
<blockquote>
<div><p>if solve_for=”rw”, temp will be w_convect (cm/s)</p>
</div></blockquote>
</p></li>
<li><p><strong>grav</strong> (<em>float</em>) – acceleration of gravity (cm/s^2)</p></li>
<li><p><strong>mw_atmos</strong> (<em>float</em>) – atmospheric molecular weight (g/mol)</p></li>
<li><p><strong>mfp</strong> (<em>float</em>) – atmospheric molecular mean free path (cm)</p></li>
<li><p><strong>visc</strong> (<em>float</em>) – atmospheric dynamic viscosity (dyne s/cm^2) see Eqn. B2 in A&amp;M</p></li>
<li><p><strong>t</strong> (<em>float</em>) – atmospheric temperature (K)</p></li>
<li><p><strong>p</strong> (<em>float</em>) – atmospheric pressure (dyne/cm^2)</p></li>
<li><p><strong>rhop</strong> (<em>float</em>) – density of particle (g/cm^3)</p></li>
<li><p><strong>lo</strong> (<em>float</em>) – lower bound for root-finder</p></li>
<li><p><strong>hi</strong> (<em>float</em>) – upper bound for root-finder</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>soln.root</strong> – the value of the parameter solve_for</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.root_functions.vfall">
<code class="sig-prename descclassname">virga.root_functions.</code><code class="sig-name descname">vfall</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">grav</em>, <em class="sig-param">mw_atmos</em>, <em class="sig-param">mfp</em>, <em class="sig-param">visc</em>, <em class="sig-param">t</em>, <em class="sig-param">p</em>, <em class="sig-param">rhop</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.vfall" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate fallspeed for a spherical particle at one layer in an
atmosphere, depending on Reynolds number for Stokes flow.</p>
<p>For Re_Stokes &lt; 1, use Stokes velocity with slip correction
For Re_Stokes &gt; 1, use fit to Re = exp( b1*x + b2*x^2 )</p>
<blockquote>
<div><p>where x = log( Cd Re^2 / 24 )
where b2 = -0.1 (curvature term) and
b1 from fit between Stokes at Re=1, Cd=24 and Re=1e3, Cd=0.45</p>
</div></blockquote>
<p>and Precipitation, Reidel, Holland, 1978) and Carlson, Rossow, and
Orton (J. Atmos. Sci. 45, p. 2066, 1988)</p>
<p>all units are cgs</p>
<ol class="upperalpha simple">
<li><p>Ackerman Feb-2000</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – particle radius (cm)</p></li>
<li><p><strong>grav</strong> (<em>float</em>) – acceleration of gravity (cm/s^2)</p></li>
<li><p><strong>mw_atmos</strong> (<em>float</em>) – atmospheric molecular weight (g/mol)</p></li>
<li><p><strong>mfp</strong> (<em>float</em>) – atmospheric molecular mean free path (cm)</p></li>
<li><p><strong>visc</strong> (<em>float</em>) – atmospheric dynamic viscosity (dyne s/cm^2) see Eqn. B2 in A&amp;M</p></li>
<li><p><strong>t</strong> (<em>float</em>) – atmospheric temperature (K)</p></li>
<li><p><strong>p</strong> (<em>float</em>) – atmospheric pressure (dyne/cm^2)</p></li>
<li><p><strong>rhop</strong> (<em>float</em>) – density of particle (g/cm^3)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="virga.root_functions.vfall_find_root">
<code class="sig-prename descclassname">virga.root_functions.</code><code class="sig-name descname">vfall_find_root</code><span class="sig-paren">(</span><em class="sig-param">r</em>, <em class="sig-param">grav=None</em>, <em class="sig-param">mw_atmos=None</em>, <em class="sig-param">mfp=None</em>, <em class="sig-param">visc=None</em>, <em class="sig-param">t=None</em>, <em class="sig-param">p=None</em>, <em class="sig-param">rhop=None</em>, <em class="sig-param">w_convect=None</em><span class="sig-paren">)</span><a class="headerlink" href="#virga.root_functions.vfall_find_root" title="Permalink to this definition">¶</a></dt>
<dd><p>This is used to find F(X)-y=0 where F(X) is the fall speed for
a spherical particle and <cite>y</cite> is the convective velocity scale.
When the two are balanced we arrive at our correct particle radius.</p>
<p>Therefore, it is the same as the <cite>vfall</cite> function but with the
subtraction of the convective velocity scale (cm/s) w_convect.</p>
</dd></dl>

</div>
<div class="section" id="module-virga">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-virga" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="notebooks/5_SwitchingSolver.html" class="btn btn-neutral float-left" title="Switching the Solver" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>